import{s as K,b9 as L,aj as te,a3 as W,y as V,ay as ae,aK as U,al as me,v as $,w as R,aG as z,E as M,G as j,cj as ne,bz as q,aF as ce,am as fe,an as re,ap as he,b0 as pe,ah as H,aB as ie,aN as J,ck as le,f,cl as be,L as O,cm as ve,K as se,aE as G,x as Q,ao as X,cn as ge,k as ye,z as P,P as oe,Q as w,a1 as Y,ci as Z,bd as Ce,co as de,X as Ie,cp as Ve,cq as Ae,cr as Ee,aH as Ne,aI as Se}from"./index-Cks8rTuj.js";function ue(k,u){return u.reduce(function(t,e){return t[e]=Ce(e,k),t},{})}var ee=function(k){K(u,k);function u(t){var e=k.call(this,t)||this;e.subFormDefaultValues=[],e.keys=[],e.toDispose=[],e.id=L(),e.refsMap={},e.makeFormRef=te(function(s){return function(o){return e.formRef(o,s)}}),e.memoizedFormatValue=te(function(s,o,i,m,d){return W(ae(d,V({index:m,__index:m},d)),V(V({},i),Array.isArray(o)?ue(d,o):null))},function(s,o,i,m,d){return Array.isArray(o)?JSON.stringify([i,m,d,ue(d,o)]):JSON.stringify(s?[i,m]:[i,m,d])}),e.handleChange=e.handleChange.bind(e),e.handleRadioChange=e.handleRadioChange.bind(e),e.handleSingleFormChange=e.handleSingleFormChange.bind(e),e.handleSingleFormInit=e.handleSingleFormInit.bind(e),e.handleFormInit=e.handleFormInit.bind(e),e.handleAction=e.handleAction.bind(e),e.addItem=e.addItem.bind(e),e.deleteItem=e.deleteItem.bind(e),e.dragTipRef=e.dragTipRef.bind(e),e.flush=e.flush.bind(e),e.handleComboTypeChange=e.handleComboTypeChange.bind(e),e.handleSubFormValid=e.handleSubFormValid.bind(e),e.defaultValue=V({},t.scaffold);var n=t.store;t.value;var r=t.multiple,a=t.formItem,l=t.addHook;return n.config({multiple:r,minLength:e.resolveVariableProps(t,"minLength"),maxLength:e.resolveVariableProps(t,"maxLength"),length:e.getValueAsArray(t).length}),a&&U(a)&&a.setSubStore(n),l&&e.toDispose.push(l(e.flush,"flush")),e}return u.prototype.componentDidUpdate=function(t){var e=this.props;if(me(["minLength","maxLength","value"],t,e)||this.resolveVariableProps(t,"minLength")!==this.resolveVariableProps(e,"minLength")||this.resolveVariableProps(t,"maxLength")!==this.resolveVariableProps(e,"maxLength")){var n=e.store,r=e.multiple,a=this.getValueAsArray(e);n.config({multiple:r,minLength:this.resolveVariableProps(e,"minLength"),maxLength:this.resolveVariableProps(e,"maxLength"),length:a.length}),n.activeKey>=a.length&&n.setActiveKey(Math.max(0,a.length-1)),e.value!==t.value&&!t.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map(function(l,s){return V(V({},l),{values:a[s]})}))}},u.prototype.componentWillUnmount=function(){var t,e,n,r,a=this.props.formItem;a&&U(a)&&a.setSubStore(null),this.toDispose.forEach(function(l){return l()}),this.toDispose=[],(e=(t=this.memoizedFormatValue.cache).clear)===null||e===void 0||e.call(t),(r=(n=this.makeFormRef.cache).clear)===null||r===void 0||r.call(n)},u.prototype.resolveVariableProps=function(t,e){var n={minLength:0,maxLength:1/0},r=t[e];if(!r)return n[e];if(typeof r=="string")if($(r)){var a=R(r,t.data,"| raw");r=typeof a=="number"&&a>=0?a:n[e]}else{var l=parseInt(r,10);r=isNaN(l)?n[e]:l}return r},u.prototype.doAction=function(t,e,n,r){var a,l,s,o,i=t==null?void 0:t.actionType,m=this.props,d=m.onChange,h=m.resetValue,c=m.formStore,b=m.store,v=m.name;if(i==="addItem")this.addItemValue((a=r==null?void 0:r.item)!==null&&a!==void 0?a:{});else if(i==="clear")d("");else if(i==="reset"){var p=(o=z((l=c==null?void 0:c.pristine)!==null&&l!==void 0?l:(s=b==null?void 0:b.parentStore)===null||s===void 0?void 0:s.pristine,v))!==null&&o!==void 0?o:h;d(p??"")}},u.prototype.addItemValue=function(t){var e=this.props,n=e.flat,r=e.joinValues,a=e.addattop,l=e.delimiter,s=e.disabled,o=e.submitOnChange;if(!s){var i=this.getValueAsArray();a===!0?(this.keys.unshift(L()),i.unshift(t)):(i.push(t),this.keys.push(L())),n&&r&&(i=i.join(l||",")),this.props.onChange(i,o,!0)}},u.prototype.getValueAsArray=function(t){t===void 0&&(t=this.props);var e=t.flat,n=t.joinValues,r=t.delimiter;t.type,t.formItem;var a=t.getValue();return n&&e&&typeof a=="string"?a=a.split(r||","):Array.isArray(a)?a=a.concat():a=[],a},u.prototype.addItemWith=function(t){var e,n,r=this.props,a=r.flat,l=r.joinValues,s=r.addattop,o=r.delimiter,i=r.scaffold,m=r.disabled,d=r.submitOnChange;if(!m){var h=this.getValueAsArray();h.push(a?(n=(e=t.scaffold)!==null&&e!==void 0?e:i)!==null&&n!==void 0?n:"":V({},t.scaffold||i)),this.keys.push(L()),a&&l&&(h=h.join(o||",")),s===!0&&(this.keys.unshift(this.keys.pop()),h.unshift(h.pop())),this.props.onChange(h,d,!0)}},u.prototype.addItem=function(){return M(this,void 0,void 0,function(){var t,e,n,r,a,l,s,o,i,m,d,h,c;return j(this,function(b){switch(b.label){case 0:return t=this.props,e=t.flat,n=t.joinValues,r=t.addattop,a=t.delimiter,l=t.scaffold,s=t.disabled,o=t.submitOnChange,i=t.dispatchEvent,m=t.store,s?[2]:(d=this.getValueAsArray(),[4,i("add",H(this.props,{value:e&&n?d.join(a||","):de(d)}))]);case 1:return h=b.sent(),h!=null&&h.prevented?[2]:(d.push(e?l??"":V({},l)),this.keys.push(L()),e&&n&&(d=d.join(a||",")),c=this.keys.length-1,r===!0&&(this.keys.unshift(this.keys.pop()),d.unshift(d.pop()),c=0),m.setActiveKey(c),this.props.onChange(d,o,!0),[2])}})})},u.prototype.deleteItem=function(t){var e,n;return M(this,void 0,void 0,function(){var r,a,l,s,o,i,m,d,h,c,b,v,p,g,A,y,C;return j(this,function(I){switch(I.label){case 0:return r=this.props,a=r.flat,l=r.joinValues,s=r.delimiter,o=r.disabled,i=r.deleteApi,m=r.deleteConfirmText,d=r.data,h=r.env,c=r.translate,b=r.dispatchEvent,v=r.submitOnChange,o?[2]:(p=this.getValueAsArray(),g=W(d,p[t]),[4,b("delete",H(this.props,{key:t,value:a&&l?p.join(s||","):de(p),item:p[t]}))]);case 1:return A=I.sent(),A!=null&&A.prevented?[2]:Ie(i,g)?[4,h.confirm(m?se(m,g):c("deleteConfirm"))]:[3,4];case 2:return y=I.sent(),y?[4,h.fetcher(i,g)]:[2];case 3:if(C=I.sent(),!C.ok)return!(i!=null&&i.silent)&&h.notify("error",(n=(e=i==null?void 0:i.messages)===null||e===void 0?void 0:e.failed)!==null&&n!==void 0?n:c("deleteFailed")),[2];I.label=4;case 4:return this.keys.splice(t,1),p.splice(t,1),a&&l&&(p=p.join(s||",")),this.props.onChange(p,v,!0),[2]}})})},u.prototype.handleChange=function(t,e,n){var r,a,l,s,o=n.index,i=this.props,m=i.flat,d=i.store,h=i.joinValues,c=i.delimiter,b=i.disabled,v=i.submitOnChange,p=i.type,g=i.syncFields,A=i.name;if(!b){Array.isArray(g)&&g.forEach(function(F){A!=null&&A.startsWith(F)&&(t=V({},t),ne(t,A))});var y=this.getValueAsArray();if(y[o]=m?t.flat:V({},t),m&&h&&(y=y.join(c||",")),p==="input-kv"){var C=!1,I={};try{for(var E=q(y),N=E.next();!N.done;N=E.next()){var S=N.value;I[S.key]?C=!0:I[S.key]=!0}}catch(F){r={error:F}}finally{try{N&&!N.done&&(a=E.return)&&a.call(E)}finally{if(r)throw r.error}}C||this.props.onChange(y,v,!0)}else if(p==="input-kvs"){var C=!1,I={};try{for(var x=q(y),B=x.next();!B.done;B=x.next()){var S=B.value;"_key"in S&&(I[S._key]?C=!0:I[S._key]=!0)}}catch(_){l={error:_}}finally{try{B&&!B.done&&(s=x.return)&&s.call(x)}finally{if(l)throw l.error}}C||this.props.onChange(y,v,!0)}else this.props.onChange(y,v,!0);d.forms.forEach(function(F){return U(F)&&F.items.forEach(function(T){return T.unique&&T.syncOptions(void 0,F.data)})})}},u.prototype.handleRadioChange=function(t,e){var n=e.index,r=e.name,a=e.trueValue,l=a===void 0?!0:a,s=e.falseValue,o=s===void 0?!1:s,i=this.props,m=i.onChange,d=i.submitOnChange,h=i.multiple,c=i.disabled;if(!(!h||c||!r)){var b=this.getValueAsArray();if(!(!Array.isArray(b)||b.length<2||!ce(b[0])))return b=b.map(function(v,p){var g;return V(V({},v),(g={},g[r]=p===n?l:o,g))}),m(b,d,!0),!1}},u.prototype.handleSingleFormChange=function(t){this.props.value===null&&fe(this.defaultValue,t)||this.props.onChange(V({},t),this.props.submitOnChange,!0)},u.prototype.handleSubFormValid=function(t,e){var n=e.index,r=this.props.store;r.setMemberValid(t,n)},u.prototype.handleFormInit=function(t,e){var n,r=e.index,a=this.props,l=a.syncDefaultValue,s=a.flat,o=a.joinValues,i=a.delimiter,m=a.formInited,d=a.onChange,h=a.submitOnChange,c=a.setPrinstineValue,b=a.formItem,v=a.name,p=a.syncFields;if(Array.isArray(p)&&p.forEach(function(y){v!=null&&v.startsWith(y)&&(t=V({},t),ne(t,v))}),b!=null&&b.validated&&((n=this.subForms[r])===null||n===void 0||n.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:r,values:t,setted:!1}),!(l===!1||this.subFormDefaultValues.length!==this.subForms.filter(function(y){return y!==void 0}).length)){var g=this.getValueAsArray(),A=!1;this.subFormDefaultValues=this.subFormDefaultValues.map(function(y){var C=y.index,I=y.values,E=y.setted,N=s?I.flat:V({},I);return!E&&re(g[C],N)&&(g[C]=s?I.flat:V({},I),A=!0),{index:C,values:I,setted:!0}}),A&&(s&&o&&(g=g.join(i||",")),m?d(g,h,!0):c(g))}},u.prototype.handleSingleFormInit=function(t){var e=this.props,n=e.syncDefaultValue,r=e.setPrinstineValue,a=e.value,l=e.nullable;n!==!1&&!l&&re(a,t)&&r(V({},t))},u.prototype.handleAction=function(t,e){var n=this.props.onAction;if(e.actionType==="delete"){e.index!==void 0&&this.deleteItem(e.index);return}n&&n.apply(null,arguments)},u.prototype.validate=function(){var t=this,e=this.props,n=e.messages,r=e.nullable,a=e.value,l=e.translate,s=e.store,o=e.flat,i=this.getValueAsArray(),m=this.resolveVariableProps(this.props,"minLength"),d=this.resolveVariableProps(this.props,"maxLength");if(m&&(!Array.isArray(i)||i.length<m))return l(n&&n.minLengthValidateFailed||"Combo.minLength",{minLength:m});if(d&&Array.isArray(i)&&i.length>d)return l(n&&n.maxLengthValidateFailed||"Combo.maxLength",{maxLength:d});if(r&&!a)return;if(i.length){var h=this.subForms;return Promise.all(i.map(function(c,b){return M(t,void 0,void 0,function(){var v,p,g,A,y,C,I,E,N,S,x,B;return j(this,function(F){switch(F.label){case 0:return v=h[b],v?[2,v.validate(!0,!1,!1)]:[3,1];case 1:if(p=h[Object.keys(h)[0]],!p)return[3,10];g=p.props.store,A=!1,F.label=2;case 2:F.trys.push([2,7,8,9]),y=q(g.items),C=y.next(),F.label=3;case 3:return C.done?[3,6]:(I=C.value,E=Ae(I),N=o?c:z(c,I.name,!1),I.extraName&&!o&&(N=[z(c,I.name,!1),z(c,I.extraName,!1)]),E.changeTmpValue(N,"dataChanged"),[4,E.validate(c)]);case 4:if(A=F.sent(),Ve(E),A===!1)return[3,6];F.label=5;case 5:return C=y.next(),[3,3];case 6:return[3,9];case 7:return S=F.sent(),x={error:S},[3,9];case 8:try{C&&!C.done&&(B=y.return)&&B.call(y)}finally{if(x)throw x.error}return[7];case 9:return s.setMemberValid(A,b),[2,A];case 10:return[2]}})})})).then(function(c){if(~c.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")})}else if(this.subForms.length)return Promise.all(this.subForms.map(function(c){return c.validate(!0,!1,!1)})).then(function(c){if(~c.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")})},u.prototype.flush=function(){return M(this,void 0,void 0,function(){return j(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.subForms.map(function(e){return e.flush()}))];case 1:return t.sent(),[2]}})})},u.prototype.dragTipRef=function(t){!this.dragTip&&t?this.initDragging():this.dragTip&&!t&&this.destroyDragging(),this.dragTip=t},u.prototype.initDragging=function(){var t=this,e=this.props.classPrefix,n=this.props.submitOnChange,r=he.findDOMNode(this);this.sortable=new pe(r.querySelector(".".concat(e,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(e,"Combo-itemDrager"),ghostClass:"".concat(e,"Combo-item--dragging"),onEnd:function(a){if(a.newIndex!==a.oldIndex){var l=a.to;a.oldIndex<l.childNodes.length-1?l.insertBefore(a.item,l.childNodes[a.oldIndex>a.newIndex?a.oldIndex+1:a.oldIndex]):l.appendChild(a.item);var s=t.props.value;if(Array.isArray(s)){var o=s.concat();o.splice(a.newIndex,0,o.splice(a.oldIndex,1)[0]),t.keys.splice(a.newIndex,0,t.keys.splice(a.oldIndex,1)[0]),t.props.onChange(o,n,!0),t.props.dispatchEvent("dragEnd",H(t.props,{item:o[a.newIndex],value:o,index:a.newIndex,oldValue:s,oldIndex:a.oldIndex}))}}}})},u.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(u.prototype,"subForms",{get:function(){var t=this;return Object.keys(this.refsMap).map(function(e){return parseInt(e,10)}).sort().map(function(e){return t.refsMap[e]})},enumerable:!1,configurable:!0}),u.prototype.formRef=function(t,e){if(e===void 0&&(e=0),t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.refsMap[e]=t}else this.refsMap[e],this.subFormDefaultValues=this.subFormDefaultValues.filter(function(n){var r=n.index;return r!==e}),delete this.refsMap[e]},u.prototype.formatValue=function(t,e){e===void 0&&(e=-1);var n=this.props,r=n.flat,a=n.data,l=n.strictMode,s=n.syncFields;return r&&(t={flat:t}),t=t||this.defaultValue,this.memoizedFormatValue(l!==!1,s,t,e,a)},u.prototype.pickCondition=function(t){var e=this.props.conditions;return ie(e,function(n){return n.test&&J(n.test,t)})},u.prototype.handleComboTypeChange=function(t,e){var n=this.props,r=n.multiple,a=n.onChange,l=n.value;n.flat;var s=n.submitOnChange,o=this.props.conditions,i=ie(o,function(d){return d.label===e.label});if(i)if(r){var m=this.getValueAsArray();m.splice(t,1,V({},le(i.scaffold||{},m[t]))),a(m,s,!0)}else a(V({},le(i.scaffold||{},l)),s,!0)},u.prototype.handleTabSelect=function(t){return M(this,void 0,void 0,function(){var e,n,r,a,l,s,o,i,m;return j(this,function(d){switch(d.label){case 0:return e=this.props,n=e.store,r=e.data,a=e.name,l=e.value,s=e.dispatchEvent,o={key:t,item:l[t]},[4,s("tabsChange",W(r,a?V(V({},o),(m={},m[a]=l,m)):o))];case 1:return i=d.sent(),i!=null&&i.prevented?[2]:(n.setActiveKey(t),[2])}})})},u.prototype.setNull=function(t){t.preventDefault();var e=this.props.onChange;e(null),this.subForms.forEach(function(n){n.clearErrors()})},u.prototype.renderPlaceholder=function(){var t=this.props,e=t.placeholder,n=t.translate;return f.createElement("span",{className:"text-muted"},n(e||"placeholder.noData"))},u.prototype.renderTabsMode=function(){var t=this,e=this.props;e.classPrefix;var n=e.classnames,r=e.tabsStyle;e.formClassName,e.render;var a=e.disabled,l=e.store,s=e.flat;e.subFormMode,e.addButtonText;var o=e.addable,i=e.removable,m=e.typeSwitchable,d=e.itemRemovableOn,h=e.delimiter;e.canAccessSuperData,e.addIcon;var c=e.deleteIcon,b=e.tabsLabelTpl,v=e.conditions;e.changeImmediately;var p=e.addBtnText;e.static;var g=e.translate,A=e.testIdBuilder,y=this.props.items,C=this.props.value;s&&typeof C=="string"&&(C=C.split(h||","));var I=l.removable!==!1&&!a&&i!==!1;return Array.isArray(C)||(C=[]),f.createElement(be,{addBtnText:g(p||"add"),className:"ComboTabs",mode:r,activeKey:l.activeKey,onSelect:this.handleTabSelect,testIdBuilder:A,additionBtns:!a&&o!==!1&&l.addable?f.createElement("li",{className:n("Tabs-link ComboTabs-addLink")},this.renderAddBtn()):null},C.map(function(E,N){var S=t.formatValue(E,N),x=A==null?void 0:A.getChild("tab-".concat(N)),B=null,F=void 0;I&&(!d||J(d,E)!==!1)&&(F=f.createElement("div",V({onClick:t.deleteItem.bind(t,N),key:"delete",className:n("Combo-tab-delBtn ".concat(l.removable?"":"is-disabled")),"data-tooltip":g("delete"),"data-position":"bottom"},x==null?void 0:x.getChild("delBtn").getTestId()),c?f.createElement("i",{className:c}):f.createElement(O,{icon:"status-close",className:"icon"}))),Array.isArray(v)&&v.length&&(B=t.pickCondition(S),y=B?B.items:void 0);var T=s&&y?[V(V({},y&&y[0]),{name:"flat"})]:y,_=Array.isArray(T)&&T.some(function(D){return D.unique});return t.keys[N]||t.keys.splice(N,0,L()),f.createElement(ve,{title:se(b||g("{{index}}",{index:S.index+1}),S),key:t.keys[N],toolbar:F,eventKey:N,mountOnEnter:!_,unmountOnExit:!1,className:l.memberValidMap[N]===!1?"has-error":"",tabClassName:l.memberValidMap[N]===!1?"has-error":"",testIdBuilder:x},B&&m!==!1?f.createElement("div",{className:n("Combo-itemTag")},f.createElement("label",null,g("Combo.type")),f.createElement(G,{onChange:t.handleComboTypeChange.bind(t,N),options:v.map(function(D){return{label:D.label,value:D.label}}),value:B.label,clearable:!1})):null,f.createElement("div",{className:n("Combo-itemInner")},T?t.renderItems(T,S,N,E):f.createElement(Q,{level:"warning",className:"m-b-none"},g("Combo.invalidData"))))}))},u.prototype.renderDelBtn=function(t,e){var n=this;if(this.props.static)return null;var r=this.props;r.classPrefix;var a=r.classnames,l=r.render,s=r.store,o=r.deleteIcon,i=r.translate,m=r.itemRemovableOn,d=r.disabled,h=r.removable,c=r.deleteBtn,b=r.mobileUI,v=r.data,p=r.testIdBuilder,g=p==null?void 0:p.getChild("delete-btn-".concat(e)),A=s.removable!==!1&&!d&&h!==!1;return A&&(!m||J(m,t)!==!1)?X(c)?l("delete-btn",V(V({},c),{type:"button",className:a("Combo-delController",c?c.className:""),testIdBuilder:g,onClick:function(y){if(!c.onClick){n.deleteItem(e);return}var C=c.onClick;typeof C=="string"&&(C=ge(c.onClick,"e","index","props"));var I=C(y,e,n.props);I&&I.then?I.then(function(){n.deleteItem(e)}):n.deleteItem(e)}}),{data:ae(v,{index:e})}):typeof c=="string"?l("delete-btn",{type:"button",className:a("Combo-delController"),label:c,onClick:this.deleteItem.bind(this,e),testIdBuilder:g}):f.createElement("a",V({onClick:this.deleteItem.bind(this,e),key:"delete",className:a("Combo-delBtn ".concat(s.removable?"":"is-disabled")),"data-tooltip":b?null:i("delete"),"data-position":"bottom"},g==null?void 0:g.getTestId()),o?f.createElement("i",{className:o}):f.createElement(O,{icon:"status-close",className:"icon"})):null},u.prototype.renderAddBtn=function(){var t=this;if(this.props.static)return null;var e=this.props;e.classPrefix;var n=e.classnames,r=e.render,a=e.addButtonClassName,l=e.store,s=e.addButtonText,o=e.addBtn,i=e.addable,m=e.addIcon,d=e.conditions,h=e.translate,c=e.tabsMode,b=e.testIdBuilder,v=Array.isArray(d)&&d.length,p=b==null?void 0:b.getChild("add-button");return f.createElement(f.Fragment,null,l.addable&&i!==!1&&(v?r("add-button",{type:"dropdown-button",icon:m?f.createElement(O,{icon:"plus-fine",className:"icon"}):"",label:h(s||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:a,testIdBuilder:p},{buttons:d==null?void 0:d.map(function(g){return{label:g.label,onClick:function(A){return t.addItemWith(g),!1}}})}):c?f.createElement("a",{onClick:this.addItem},m?f.createElement(O,{icon:"plus-fine",className:"icon"}):null,f.createElement("span",null,h(s||"add"))):X(o)?r("add-button",V(V({},o),{type:"button",testIdBuilder:p,onClick:function(){return t.addItem()}})):f.createElement(ye,{className:n("Combo-addBtn",a),onClick:this.addItem,testIdBuilder:p},m?f.createElement(O,{icon:"plus-fine",className:"icon"}):null,f.createElement("span",null,h(s||"add")))))},u.prototype.renderMultipe=function(){var t=this;if(this.props.tabsMode)return this.renderTabsMode();var e=this.props;e.classPrefix;var n=e.classnames,r=e.multiLine,a=e.disabled,l=e.flat,s=e.draggable,o=e.draggableTip,i=e.typeSwitchable,m=e.delimiter,d=e.dragIcon,h=e.noBorder,c=e.conditions,b=e.placeholder,v=e.translate,p=e.itemClassName,g=e.itemsWrapperClassName,A=e.static,y=e.mobileUI,C=e.store,I=this.props.items,E=this.props.value;return l&&typeof E=="string"&&(E=E.split(m||",")),f.createElement("div",{className:n("Combo Combo--multi",{"is-mobile":y},r?"Combo--ver":"Combo--hor",h?"Combo--noBorder":"",a?"is-disabled":"",!A&&!a&&s&&Array.isArray(E)&&E.length>1?"is-draggable":"")},f.createElement("div",{className:n("Combo-items",g)},Array.isArray(E)&&E.length?E.map(function(N,S,x){var B=t.renderDelBtn(N,S),F=t.formatValue(N,S),T=null;Array.isArray(c)&&c.length&&(T=t.pickCondition(F),I=T?T.items:void 0);var _=l&&I?[V(V({},I&&I[0]),{name:"flat"})]:I;return t.keys[S]||t.keys.splice(S,1,L()),f.createElement("div",{className:n("Combo-item",p,C.memberValidMap[S]===!1?"has-error":""),key:t.keys[S]},!A&&!a&&s&&x.length>1?f.createElement("div",{className:n("Combo-itemDrager")},f.createElement("a",{key:"drag","data-tooltip":v("Combo.dragDropSort"),"data-position":"bottom"},d?f.createElement("i",{className:d}):f.createElement(O,{icon:"drag-bar",className:"icon"}))):null,T&&i!==!1?f.createElement("div",{className:n("Combo-itemTag")},f.createElement("label",null,v("Combo.type")),f.createElement(G,{onChange:t.handleComboTypeChange.bind(t,S),options:c.map(function(D){return{label:D.label,value:D.label}}),value:T.label,clearable:!1})):null,f.createElement("div",{className:n("Combo-itemInner")},_?t.renderItems(_,F,S,N):f.createElement(Q,{level:"warning",className:"m-b-none"},v("Combo.invalidData"))),B)}):b?f.createElement("div",{className:n("Combo-placeholder")},v(b)):null),!A&&!a?f.createElement("div",{className:n("Combo-toolbar")},this.renderAddBtn(),s?f.createElement("span",{className:n("Combo-dragableTip"),ref:this.dragTipRef},Array.isArray(E)&&E.length>1?v(o):""):null):null)},u.prototype.renderSingle=function(){var t=this.props,e=t.conditions,n=t.classnames,r=t.value,a=t.multiLine,l=t.noBorder,s=t.disabled,o=t.typeSwitchable,i=t.nullable,m=t.translate,d=t.itemClassName,h=t.mobileUI,c=t.store,b=this.props.items,v=X(r)?this.formatValue(r):this.formatValue(this.defaultValue),p=null;return Array.isArray(e)&&e.length&&(p=this.pickCondition(v),b=p?p.items:void 0),f.createElement("div",{className:n("Combo Combo--single",{"is-mobile":h},a?"Combo--ver":"Combo--hor",l?"Combo--noBorder":"",s?"is-disabled":"")},f.createElement("div",{className:n("Combo-item",d,c.memberValidMap[0]===!1?"has-error":"")},p&&o!==!1?f.createElement("div",{className:n("Combo-itemTag")},f.createElement("label",null,m("Combo.type")),f.createElement(G,{onChange:this.handleComboTypeChange.bind(this,0),options:e.map(function(g){return{label:g.label,value:g.label}}),value:p.label,clearable:!1})):null,f.createElement("div",{className:n("Combo-itemInner")},b?this.renderItems(b,v):f.createElement(Q,{level:"warning",className:"m-b-none"},m("Combo.invalidData")))),r&&i?f.createElement("a",{className:n("Combo-setNullBtn"),href:"#",onClick:this.setNull},m("clear")):null)},u.prototype.renderItems=function(t,e,n,r){var a=this.props,l=a.classnames,s=a.formClassName,o=a.render,i=a.multiLine,m=a.disabled,d=a.canAccessSuperData,h=a.multiple,c=a.tabsMode,b=a.subFormMode,v=a.subFormHorizontal,p=a.changeImmediately,g=a.lazyLoad;a.translate;var A=a.static,y=a.testIdBuilder,C=a.updatePristineAfterStoreDataReInit,I=Array.isArray(t)?t.map(function(E,N){var S=n!==void 0&&n>=0?"-".concat(n):"",x="item-".concat(E.testid||E.id||N)+S;return V(V({},E),{testIdBuilder:y==null?void 0:y.getChild(x)})}):t;if(h){if(h&&n!==void 0&&n>=0)return o("multiple/".concat(n),{type:"form",body:I,wrapperComponent:"div",wrapWithPanel:!1,mode:c||i?b:"row",horizontal:v,className:l("Combo-form",s)},V(V({index:n,disabled:m,static:A,data:e,originData:r,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(n),onValidChange:this.handleSubFormValid,canAccessSuperData:d,lazyChange:!p,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},c?{}:{lazyLoad:g}),{updatePristineAfterStoreDataReInit:C??!1}))}else return o("single",{type:"form",body:I,wrapperComponent:"div",wrapWithPanel:!1,mode:i?b||"normal":"row",horizontal:v,className:l("Combo-form",s)},{index:0,disabled:m,static:A,data:e,originData:r,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:d,lazyChange:!p,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:C??!1});return f.createElement(f.Fragment,null)},u.prototype.renderStatic=function(t){return this.props.render("static-input-kv",{type:"json"},this.props)},u.prototype.render=function(){var t=this.props,e=t.type,n=t.formInited,r=t.multiple,a=t.className;t.style,t.classPrefix;var l=t.classnames,s=t.static,o=t.staticSchema;return s&&(o||["input-kv","input-kvs"].includes(e))?this.renderStatic():n||typeof n>"u"?f.createElement("div",{className:l("ComboControl",a)},r?this.renderMultipe():this.renderSingle()):null},u.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},u.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],P([oe,w("design:type",Function),w("design:paramtypes",[Number]),w("design:returntype",Promise)],u.prototype,"handleTabSelect",null),P([oe,w("design:type",Function),w("design:paramtypes",[Object]),w("design:returntype",void 0)],u.prototype,"setNull",null),u}(f.Component),xe=function(k){K(u,k);function u(){return k!==null&&k.apply(this,arguments)||this}return u.prototype.setData=function(t,e,n,r){return M(this,void 0,void 0,function(){var a,l,s,o,i,m,d,h,c,b;return j(this,function(v){switch(v.label){case 0:return a=this.props,l=a.multiple,s=a.onChange,o=a.submitOnChange,l?(i=Ne([],Se(this.getValueAsArray()),!1),m=i.length,n===void 0?[3,1]:(d=String(n).split(","),d.forEach(function(p){var g=Number(p);i.splice(g,1,V(V({},i[g]),t))}),s==null||s(i,o,!0),[3,7])):[3,8];case 1:if(r===void 0)return[3,6];h=0,v.label=2;case 2:return h<m?(c=i[h],[4,Ee(r,c)]):[3,5];case 3:b=v.sent(),b&&i.splice(h,1,V(V({},i[h]),t)),v.label=4;case 4:return h++,[3,2];case 5:return s==null||s(i,o,!0),[3,7];case 6:s==null||s(t,o,!0),v.label=7;case 7:return[3,9];case 8:s==null||s(t,o,!0),v.label=9;case 9:return[2]}})})},u=P([Y({type:"combo",storeType:Z.name,extendsData:!1,shouldComponentUpdate:function(t,e){return $(t.maxLength)&&R(e.maxLength,e.data)!==R(t.maxLength,t.data)||$(t.minLength)&&R(e.minLength,e.data)!==R(t.minLength,t.data)}})],u),u}(ee),ke=function(k){K(u,k);function u(){return k!==null&&k.apply(this,arguments)||this}return u=P([Y({type:"input-kv",storeType:Z.name,extendsData:!1})],u),u}(ee),Be=function(k){K(u,k);function u(){return k!==null&&k.apply(this,arguments)||this}return u=P([Y({type:"input-kvs",storeType:Z.name,extendsData:!1})],u),u}(ee);export{xe as ComboControlRenderer,ke as KVControlRenderer,Be as KVSControlRenderer,ee as default};
