import{s as J,y,E as A,G as O,f as C,e5 as Ee,L as V,ap as ye,e6 as ke,bn as ue,a3 as N,e7 as pe,z as S,D as be,e8 as Fe,e9 as Ae,ea as Oe,ba as oe,ai as he,w as se,aN as L,aH as z,aI as U,eb as Ne,al as W,v as fe,aO as Te,am as ve,ao as H,t as $,K as Q,ad as G,X as le,aw as me,aK as Be,a$ as X,ec as De,ed as Ie,ae as _e,T as je,P as x,Q as p,ee as Ke,dh as qe,co as Me,cr as Le}from"./index-Cks8rTuj.js";import"./ColumnToggler-CDztuP_a.js";var Pe=function(F){J(l,F);function l(e){var t=F.call(this,e)||this;return t.formItems=[],t.handleSubmit=t.handleSubmit.bind(t),t.handleAction=t.handleAction.bind(t),t}return l.prototype.buildSchema=function(){var e,t,r,n,a,i,s=this.props,o=s.searchable,d=s.sortable,c=s.name,v=s.label,b=s.translate,f=s.testIdBuilder,u;if(o===!0?u={title:"",controls:[{type:"text",name:c,placeholder:v,clearable:!0,testid:(e=f==null?void 0:f.getChild(c))===null||e===void 0?void 0:e.getTestIdValue()}]}:o&&(o.controls||o.tabs||o.fieldSet?u=y(y({title:""},o),{controls:Array.isArray(o.controls)?o.controls.concat():void 0}):(o==null?void 0:o.type)==="form"?u=o:u={title:"",className:o.formClassName,controls:[y({type:o.type||"text",name:o.name||c,testid:(t=f==null?void 0:f.getChild(o.name||c))===null||t===void 0?void 0:t.getTestIdValue(),placeholder:v},o)]}),u&&u.controls&&d&&u.controls.unshift({type:"hidden",name:"orderBy",value:c},{type:"button-group",name:"order",label:b("sort"),options:[{label:b("asc"),value:"asc"},{label:b("desc"),value:"desc"}]}),u){var m=[];(u.controls||u.body||[]).forEach(function(g){return g.name&&g.name!=="orderBy"&&g.name!=="order"&&m.push(g.name)}),this.formItems=m,u=y(y({},u),{type:"form",wrapperComponent:"div",wrapWithPanel:!0,title:!1,testid:(r=f==null?void 0:f.getChild("form"))===null||r===void 0?void 0:r.getTestIdValue(),actions:[{type:"button",label:b("reset"),actionType:"clear-and-submit",testid:(n=f==null?void 0:f.getChild("btn-reset"))===null||n===void 0?void 0:n.getTestIdValue()},{type:"button",label:b("cancel"),actionType:"cancel",testid:(a=f==null?void 0:f.getChild("btn-cancel"))===null||a===void 0?void 0:a.getTestIdValue()},{label:b("search"),type:"submit",primary:!0,testid:(i=f==null?void 0:f.getChild("btn-search"))===null||i===void 0?void 0:i.getTestIdValue()}]})}return u||"error"},l.prototype.handleAction=function(e,t,r,n){return A(this,void 0,void 0,function(){var a,i,s,o,d,c,v;return O(this,function(b){switch(b.label){case 0:return a=this.props,i=a.onAction,s=a.data,o=a.dispatchEvent,d=a.name,t.actionType==="cancel"||t.actionType==="close"?(n(),[2]):t.actionType==="reset"?(n(),this.handleReset(),[2]):(c=y({},s),this.formItems.forEach(function(f){return ue(c,f,void 0)}),[4,o("columnSearch",N(s,{searchName:d,searchValue:c}))]);case 1:return v=b.sent(),v!=null&&v.prevented?[2]:(i&&i(e,t,r),[2])}})})},l.prototype.handleReset=function(){return A(this,void 0,void 0,function(){var e,t,r,n,a,i;return O(this,function(s){switch(s.label){case 0:return e=this.props,t=e.onSearch,r=e.data,n=e.name,a=y({},r),this.formItems.forEach(function(o){return ue(a,o,void 0)}),a.orderBy===n&&(a.orderBy="",a.order="asc"),i=t,i?[4,t(n,a)]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return t&&t(a),[2]}})})},l.prototype.handleSubmit=function(e,t){return A(this,void 0,void 0,function(){var r,n,a,i;return O(this,function(s){switch(s.label){case 0:return r=this.props,n=r.onSearch,a=r.name,e.order&&(e=y(y({},e),{orderBy:a})),i=n,i?[4,n(a,e)]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return t(),[2]}})})},l.prototype.isActive=function(){var e=this.props,t=e.data,r=e.name,n=e.orderBy;return n&&n===r||this.formItems.some(function(a){return t==null?void 0:t[a]})},l.prototype.render=function(){var e=this,t=this.props,r=t.render,n=t.name,a=t.data,i=t.searchable,s=t.order,o=t.orderBy,d=t.popOverContainer,c=t.classPrefix,v=t.classnames,b=t.testIdBuilder,f=this.buildSchema(),u=this.isActive();return C.createElement(Ee,{className:"".concat(c,"TableCell-searchBtn"),layerClassName:v("".concat(c,"TableCell-searchPopOver"),i.className),active:u,filterIcon:C.createElement(V,{icon:"search",className:"icon",iconContent:"table-search-icon",testIdBuilder:b==null?void 0:b.getChild("search-icon")}),popOverContainer:d||function(){return ye.findDOMNode(e)},filterDropdown:function(m){m.setSelectedKeys,m.selectedKeys;var g=m.confirm;return m.clearFilters,r("quick-search-form",f,{data:y(y({},a),{orderBy:o,order:o&&o===n?s:""}),onSubmit:function(h){return e.handleSubmit(h,g)},onAction:function(h,R,w){e.handleAction(h,R,w,g)}})},testIdBuilder:b})},l}(C.Component),He=ke(function(F){var l=F.store;return C.createElement(Pe,y({},F,{data:l.query,orderBy:l.orderBy,order:l.order}))});(function(F){J(l,F);function l(){var e=F!==null&&F.apply(this,arguments)||this;return e.propsNeedRemove=["title"],e}return l.defaultProps=y(y({},pe.defaultProps),{wrapperComponent:"div"}),l=S([be({type:"cell-field",name:"cell-field"}),Fe(),Ae(),Oe()],l),l})(pe);var Qe=function(F){J(l,F);function l(e,t){var r=F.call(this,e)||this;r.renderedToolbars=[],r.subForms={},r.columns=[],r.reactions=[];var n=t;n.registerComponent(r);var a=e.store,i=e.columnsTogglable,s=e.columns,o=e.rowSelection,d=e.keyField,c=e.primaryField,v=e.canAccessSuperData;return a.update({columnsTogglable:i,columns:s,canAccessSuperData:v,rowSelectionKeyField:c||(o==null?void 0:o.keyField)||d}),l.syncRows(a,e,void 0)&&r.syncSelected(),r.columns=r.buildColumns(a.filteredColumns,[],[]),r.rowSelection=r.buildRowSelection(),r.expandable=r.buildExpandable(),r.reactions.push(oe(function(){return a.currentSelectedRowKeys.join(",")},function(){r.rowSelection=r.buildRowSelection(),r.forceUpdate()})),r.reactions.push(oe(function(){return a.currentExpandedKeys.join(",")},function(){r.expandable=r.buildExpandable(),r.forceUpdate()})),r.reactions.push(oe(function(){return a.filteredColumns},function(){r.columns=r.buildColumns(a.filteredColumns,[],[]),r.forceUpdate()})),r}return l.prototype.componentWillUnmount=function(){var e=this.context;e.unRegisterComponent(this),this.reactions&&this.reactions.forEach(function(t){return t()})},l.prototype.syncSelected=function(){var e=this.props,t=e.store,r=e.onSelect;r&&r(t.selectedRows.map(function(n){return n.data}),t.unSelectedRows.map(function(n){return n.data}))},l.syncRows=function(e,t,r){var n,a=t.source,i=he(t,function(m){return m.items}),s=[],o=!1;if(Array.isArray(i)&&(!r||he(r,function(m){return m.items})!==i))o=!0,s=i;else if(typeof a=="string"){var d=se(a,t.data,"| raw"),c=r?se(a,r.data,"| raw"):null;c&&c===d?o=!1:Array.isArray(d)&&(o=!0,s=d)}o&&e.initRows(s,t.getEntryId,t.reUseRow,t.childrenColumnName);var v=[],b=e.keyField;Array.isArray(t.selected)?v=t.selected.map(function(m){return m[b]})||[]:t.rowSelection&&t.rowSelection.selectedRowKeysExpr?s.forEach(function(m,g){var h,R=L(((h=t.rowSelection)===null||h===void 0?void 0:h.selectedRowKeysExpr)||"",{record:m,rowIndex:g});R&&v.push(m[b])}):t.rowSelection&&t.rowSelection.selectedRowKeys&&(v=z([],U(t.rowSelection.selectedRowKeys),!1)),o&&v.length>0&&e.updateSelected(v);var f=[],u=t.primaryField||((n=t.expandable)===null||n===void 0?void 0:n.keyField)||t.keyField;return t.expandable&&t.expandable.expandedRowKeysExpr?s.forEach(function(m,g){var h,R=L(((h=t.expandable)===null||h===void 0?void 0:h.expandedRowKeysExpr)||"",{record:m,rowIndex:g});R&&f.push(m[u])}):t.expandable&&t.expandable.expandedRowKeys&&(f=z([],U(t.expandable.expandedRowKeys),!1)),o&&f.length>0&&e.updateExpanded(f,u),o},l.prototype.componentDidUpdate=function(e){var t,r,n,a=this.props,i=a.store;if(Ne(["orderBy","columnsTogglable","canAccessSuperData"],e,a,function(c){c.orderBy&&!a.onQuery&&delete c.orderBy,i.update(c,{resolveDefinitions:a.resolveDefinitions})}),W(["source","value","items"],e,a)||!a.value&&!a.items&&(a.data!==e.data||typeof a.source=="string"&&fe(a.source)))l.syncRows(i,a,e)&&this.syncSelected();else if(Te(e.selected,a.selected)){var s=i.keyField,o=i.selectedRows.map(function(c){return c[s]}).join(",");i.updateSelected(a.selected.map(function(c){return c[s]})||[]);var d=i.selectedRows.map(function(c){return c[s]}).join(",");o!==d&&this.syncSelected()}W(["columns"],e,a)&&i.update({columns:a.columns}),W(["rowSelection","selectable","multiple","maxKeepItemSelectionLength"],e,a)&&(this.rowSelection=this.buildRowSelection()),W(["query","pageField","perPageField"],e,a)&&i.updateQuery(a.query,void 0,a.pageField,a.perPageField,!0),(!ve((t=e==null?void 0:e.rowSelection)===null||t===void 0?void 0:t.keyField,(r=a.rowSelection)===null||r===void 0?void 0:r.keyField)||!ve(e.keyField,a.keyField))&&i.update({rowSelectionKeyField:a.primaryField||((n=a.rowSelection)===null||n===void 0?void 0:n.keyField)||a.keyField})},l.prototype.getPopOverContainer=function(){return ye.findDOMNode(this)},l.prototype.subFormRef=function(e,t,r){var n=this.props.quickEditFormRef;n&&n(e,t,r),this.subForms["".concat(t,"-").concat(r)]=e,e&&this.props.store.addForm(e.props.store,r)},l.prototype.reset=function(){var e=this,t=this.props.store;t.reset();var r=[];Object.keys(this.subForms).forEach(function(n){return e.subForms[n]&&r.push(e.subForms[n])}),r.forEach(function(n){return n.clearErrors()})},l.prototype.renderCellSchema=function(e,t){var r=this.props,n=r.render;if(r.store,e&&H(e)){e.width,e.children;var a=e.title,i=$(e,["width","children","title"]);return n("cell-field",y(y({},i),{title:a||i.label,type:"cell-field",column:i,data:t.data,name:e.name}),t)}return e},l.prototype.renderSchema=function(e,t,r){var n=this.props.render;if(t&&H(t))return n(e||"field",y(y({},t),{data:r==null?void 0:r.data}),r);if(Array.isArray(t)){var a=[];return t.forEach(function(i,s){return a.push(n(e||"field",y(y({},i),{data:r==null?void 0:r.data}),y(y({},r),{key:s})))}),a}return typeof t=="string"?Q(t,r==null?void 0:r.data):t},l.prototype.buildColumns=function(e,t,r){var n=this,a=this.props,i=a.render,s=a.store,o=a.popOverContainer,d=a.canAccessSuperData,c=a.showBadge,v=a.itemBadge,b=a.data,f=a.classnames,u=a.env,m=a.testIdBuilder,g=[];return t=t,r=r,Array.isArray(e)&&e.forEach(function(h,R){return A(n,void 0,void 0,function(){var w,k,E,T,_,j,de,Y,Z,ce,M=this,ee,te;return O(this,function(re){switch(re.label){case 0:return w=y({},h),k=null,E={popOverContainer:o||this.getPopOverContainer,value:h.title||h.label},H(h.title)?k=Me(h.title):(typeof h.title=="string"||typeof h.label=="string")&&(k={type:"plain"}),h.align&&(k.align=h.align,k.className="flex-1"),T=function(K){var q,B=M.renderCellSchema(k,E),D=null;return h.remark&&(D=i("remark",{type:"remark",tooltip:h.remark,container:M.getPopOverContainer})),C.createElement("div",{key:R,className:f("Table-head-cell-wrapper",(q={},q["".concat(h.className)]=!!h.className,q["".concat(h.titleClassName)]=!!h.titleClassName,q)),style:{justifyContent:{right:"flex-end",center:"center"}[h.align]||"flex-start"}},B,D,K)},Object.assign(w,{title:T}),_=!!(!((ee=h.children)===null||ee===void 0)&&ee.length),te=h.canAccessSuperData,h.type&&Object.assign(w,{render:function(K,q,B,D,ge){var we={},ne=s.getRowByIndex(B,z([],U(ge||[]),!1))||{},Se=m==null?void 0:m.getChild("row-".concat(B,"-cell-").concat(D)),P={children:M.renderCellSchema(h,{data:ne.locals,btnDisabled:s.dragging,popOverContainer:o||M.getPopOverContainer,quickEditFormRef:M.subFormRef,onQuickChange:function(I,Ce,xe,Re){M.handleQuickChange(ne,I,Ce,xe,Re)},row:ne,showBadge:c&&R===0,itemBadge:v,testIdBuilder:Se}),props:we};if(!_&&h.rowSpanExpr){var ae=+Q(h.rowSpanExpr,{record:q,rowIndex:B,colIndex:D});ae&&(P.props.rowSpan=ae,t.push({colIndex:D,rowIndex:B,rowSpan:ae}))}if(!_&&h.colSpanExpr){var ie=+Q(h.colSpanExpr,{record:q,rowIndex:B,colIndex:D});ie&&(P.props.colSpan=ie,r.push({colIndex:D,rowIndex:B,colSpan:ie}))}return t.forEach(function(I){D===I.colIndex&&B>I.rowIndex&&B<I.rowIndex+(I.rowSpan||0)&&(P.props.rowSpan=0)}),r.forEach(function(I){B===I.rowIndex&&D>I.colIndex&&D<I.colIndex+(I.colSpan||0)&&(P.props.colSpan=0)}),P}}),h.searchable&&(w.filterDropdown=C.createElement(He,y({},this.props,{popOverContainer:this.getPopOverContainer,name:h.name,searchable:h.searchable,onSearch:this.handleSearch,key:"th-search-"+R,testIdBuilder:m==null?void 0:m.getChild("head-search-".concat(R))}))),h.sortable&&(w.sorter=!0),h.filterable?h.filterable.options?(w.filters=h.filterable.options.map(function(K){return typeof K=="string"?{text:K,value:K}:{text:K.label,value:K.value}}),[3,4]):[3,1]:[3,4];case 1:return h.filterable.source?(j=h.filterable.source,fe(j)?(de=se(j,b,"| raw"),w.filters=de,[3,4]):[3,2]):[3,4];case 2:return le(j,b)?(Y=qe(j),Y.cache=3e3,[4,u.fetcher(Y,b)]):[3,4];case 3:Z=re.sent(),ce=Z.data&&Z.data.options||[],w.filters=ce,re.label=4;case 4:return _&&(w.children=this.buildColumns(h.children,t,r)),g.push(w),[2]}})})}),g},l.prototype.buildSummary=function(e,t){var r=this,n=[];return Array.isArray(t)&&t.forEach(function(a,i){H(a)?n.push({colSpan:a.colSpan,fixed:a.fixed,cellClassName:a.cellClassName,render:function(s){return r.renderSchema(e,a,{data:s})}}):Array.isArray(a)&&(n[i]||n.push([]),a.forEach(function(s){n[i].push({colSpan:s.colSpan,fixed:s.fixed,cellClassName:s.cellClassName,render:function(o){return r.renderSchema(e,s,{data:o})}})}))}),n.length?n:null},l.prototype.rowClassName=function(e,t){var r=this.props,n=r.rowClassNameExpr,a=r.store,i=r.themeCss,s=r.id,o=r.rowClassName,d=[];o&&d.push(o),n&&d.push(Q(n,{record:e,rowIndex:t}));var c=a.getRowByIndex(t);return c!=null&&c.modified&&d.push("is-modified"),c!=null&&c.moved&&d.push("is-moved"),d.push(G(y(y({},this.props),{name:"tableRowClassname",id:s,themeCss:i}))),d.join(" ")},l.prototype.buildRowSelection=function(){var e=this,t=this.props,r=t.selectable,n=t.multiple,a=t.maxKeepItemSelectionLength,i=t.rowSelection,s=t.store,o=null;if(r)o={type:n===!1?"radio":"",selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:a};else if(i){i.selectedRowKeys;var d=i.selections,c=$(i,["selectedRowKeys","selections"]);o=y({selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:a},c),o.getCheckboxProps=function(v,b){var f=e.props,u=f.rowSelection,m=f.maxKeepItemSelectionLength,g=f.store,h=u==null?void 0:u.disableOn;return{disabled:(h?L(h,{record:v,rowIndex:b}):!1)||m&&g.currentSelectedRowKeys.length>=m&&!g.currentSelectedRowKeys.includes(v[g.keyField])}},i.disableOn&&delete o.disableOn,d&&Array.isArray(d)&&(o.selections=[],d.forEach(function(v){o.selections.push({key:v.key,text:v.text,onSelect:function(b){var f=[];f=b.filter(function(u,m){return v.key==="all"?!0:v.key==="none"?!1:v.key==="invert"?!s.currentSelectedRowKeys.includes(u):v.key==="odd"?m%2===0:v.key==="even"?m%2!==0:!0}),s.updateSelected(f)}})}))}return o},l.prototype.expandedRowClassName=function(e,t){var r=this.props.expandable;return Q(r==null?void 0:r.expandedRowClassNameExpr,{record:e,rowIndex:t})},l.prototype.expandedRowRender=function(e,t){var r=this.props.expandable;return this.renderSchema("expandableBody",y({},r),{data:y(y(y({},this.props.data),e),{rowIndex:t})})},l.prototype.rowExpandable=function(e,t,r){var n=this.props.expandable;return n!=null&&n.expandableOn?L(n.expandableOn,{record:e,rowIndex:t}):!1},l.prototype.buildExpandable=function(){var e=this.props,t=e.expandable,r=e.store,n=null;if(t){t.expandedRowKeys;var a=$(t,["expandedRowKeys"]);n=y({expandedRowKeys:r.currentExpandedKeys},a),t.expandableOn&&(n.rowExpandable=this.rowExpandable,delete n.expandableOn),t&&t.type&&(n.expandedRowRender=this.expandedRowRender),t.expandedRowClassNameExpr&&(n.expandedRowClassName=this.expandedRowClassName,delete n.expandedRowClassNameExpr)}return n},l.prototype.reloadTarget=function(e,t){var r=this.context;r.reload(e,t)},l.prototype.handleSave=function(){return A(this,void 0,void 0,function(){var e,t,r,n,a,i,s,o,d,c,v,b=this;return O(this,function(f){switch(f.label){case 0:return e=this.props,t=e.store,r=e.onSave,n=e.primaryField,a=e.keyField,t.modifiedRows.length?(i=[],Object.keys(this.subForms).forEach(function(u){return b.subForms[u]&&i.push(b.subForms[u])}),i.length?[4,Promise.all(i.map(function(u){return u.validate()}))]:[3,2]):[2];case 1:if(s=f.sent(),~s.indexOf(!1))return[2];f.label=2;case 2:return o=t.modifiedRows.map(function(u){return u.data}),d=t.modifiedRows.map(function(u){return u.path}),c=t.modifiedRows.map(function(u){return X(u.data,u.pristine,[a,n])}),v=t.rows.filter(function(u){return!u.modified}).map(function(u){return u.data}),r?(r(o,c,d,v,t.modifiedRows.map(function(u){return u.pristine})),[2]):(this.handleQuickSave(o,c,d,v,t.modifiedRows.map(function(u){return u.pristine})),[2])}})})},l.prototype.handleQuickSave=function(e,t,r,n,a,i){var s=this,o=this.props,d=o.store,c=o.quickSaveApi,v=o.quickSaveItemApi,b=o.primaryField,f=o.keyField,u=o.env,m=o.messages,g=o.reload,h=o.dispatchEvent;if(Array.isArray(e)){if(!le(c)){u&&u.alert("Table2 quickSaveApi is required");return}var R=b||f,w=N(d.data,{rows:e,rowsDiff:t,indexes:r,rowsOrigin:a});e.length&&e[0].hasOwnProperty(R)&&(w.ids=e.map(function(T){return T[R]}).join(",")),n&&(w.unModifiedItems=n),d.saveRemote(c,w,{successMessage:m&&m.saveFailed,errorMessage:m&&m.saveSuccess}).then(function(){h("quickSaveSubmitted",w),g&&s.reloadTarget(me(g,w),w)}).catch(function(){})}else{if(!le(v)){u&&u.alert("Table2 quickSaveItemApi is required!");return}var k=N(d.data,{item:e,modified:t,origin:a}),E=N(k,e);d.saveRemote(v,E).then(function(){h("quickSaveSubmitted",E),g&&s.reloadTarget(me(g,k),k)}).catch(function(){i!=null&&i.resetOnFailed&&s.reset()})}},l.prototype.handleQuickChange=function(e,t,r,n,a){if(Be(e)){var i=this.props,s=i.onSave,o=i.onPristineChange,d=i.saveImmediately,c=i.primaryField,v=i.keyField,b=i.quickSaveItemApi;if(e.change(t,n),e.modified&&this.syncSelected(),n){o==null||o(e.data,e.path);return}if(!(!r&&!d)){if(r&&r.api){this.props.onAction&&this.props.onAction(null,{actionType:"ajax",api:r.api,reload:a==null?void 0:a.reload},e.locals);return}if(!s){this.handleQuickSave(b?e.data:[e.data],X(e.data,e.pristine,[v,c]),[e.path],void 0,e.pristine,a);return}s(e.data,X(e.data,e.pristine,[v,c]),e.path,void 0,e.pristine,a)}}},l.prototype.handleAction=function(e,t,r){var n=this.props.onAction;n&&n(e,t,r)},l.prototype.renderActions=function(e){var t=this,r=this.props,n=r.actions,a=r.render,i=r.store,s=r.classnames,o=r.data,d=r.columnsTogglable,c=r.dispatchEvent;n=Array.isArray(n)?n.concat():[];var v=H(d)?d:{align:"left"};return i.toggable&&e==="header"&&!~this.renderedToolbars.indexOf("columns-toggler")&&n.push({type:"button",children:a("column-toggler",y(y({},v),{type:"column-toggler"}),{cols:i.columnsData,toggleAllColumns:function(){i.toggleAllColumns(),c("columnToggled",N(o,{columns:i.columnsData.filter(function(b){return b.toggled})}))},toggleToggle:function(b){var f=i.columnsData[b];f.toggleToggle(),c("columnToggled",N(o,{columns:i.columnsData.filter(function(u){return u.toggled})}))}})}),Array.isArray(n)&&n.length?C.createElement("div",{className:s("Table-toolbar")},n.map(function(b,f){return a("action/".concat(f),y({type:"button"},b),{onAction:t.handleAction,key:f,btnDisabled:i.dragging,data:i.getData(o)})})):null},l.prototype.handleSelected=function(e,t,r){return A(this,void 0,void 0,function(){var n,a,i,s,o;return O(this,function(d){switch(d.label){case 0:return n=this.props,a=n.dispatchEvent,i=n.data,s=n.store,[4,a("selectedChange",N(i,{selectedItems:e,unSelectedItems:r}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2,o==null?void 0:o.prevented]:(s.updateSelected(t),this.syncSelected(),[2])}})})},l.prototype.handleSort=function(e){return A(this,void 0,void 0,function(){var t,r,n,a,i;return O(this,function(s){switch(s.label){case 0:return t=this.props,r=t.dispatchEvent,n=t.data,a=t.onSort,[4,r("columnSort",N(n,{orderBy:e.orderBy,orderDir:e.orderDir}))];case 1:return i=s.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},l.prototype.handleFilter=function(e){return A(this,void 0,void 0,function(){var t,r,n,a,i;return O(this,function(s){switch(s.label){case 0:return t=this.props,r=t.dispatchEvent,n=t.data,a=t.onSearch,[4,r("columnFilter",N(n,e))];case 1:return i=s.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},l.prototype.handleSearch=function(e,t){return A(this,void 0,void 0,function(){var r,n,a,i,s,o,d;return O(this,function(c){switch(c.label){case 0:return r=this.props,n=r.data,a=r.dispatchEvent,i=r.store,s=r.onSearch,[4,a("columnSearch",N(n,{searchName:e,searchValue:t}))];case 1:return o=c.sent(),o!=null&&o.prevented?[2]:(i.updateQuery(t),s&&s((d={},d[e]=t[e],d)),[2])}})})},l.prototype.handleRowClick=function(e,t,r){return A(this,void 0,void 0,function(){var n,a,i,s,o;return O(this,function(d){switch(d.label){case 0:return n=this.props,a=n.dispatchEvent,i=n.data,s=n.onRow,[4,a("rowClick",N(i,{item:t,index:r}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2]:(t&&s&&s.onRowClick&&s.onRowClick(e,t,r),[2])}})})},l.prototype.handleRowDbClick=function(e,t,r){return A(this,void 0,void 0,function(){var n,a,i,s,o;return O(this,function(d){switch(d.label){case 0:return n=this.props,a=n.dispatchEvent,i=n.data,s=n.onRow,[4,a("rowDbClick",N(i,{item:t,index:r}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2,!1]:(t&&s&&s.onRowDbClick&&s.onRowDbClick(e,t,r),[2,!0])}})})},l.prototype.handleRowMouseEnter=function(e,t,r){var n;return A(this,void 0,void 0,function(){var a,i,s,o,d;return O(this,function(c){switch(c.label){case 0:return(n=e==null?void 0:e.persist)===null||n===void 0||n.call(e),a=this.props,i=a.dispatchEvent,s=a.data,o=a.onRow,[4,i("rowMouseEnter",N(s,{item:t,index:r}))];case 1:return d=c.sent(),d!=null&&d.prevented?[2]:(t&&o&&o.onRowMouseEnter&&o.onRowMouseEnter(e,t,r),[2])}})})},l.prototype.handleRowMouseLeave=function(e,t,r){var n;return A(this,void 0,void 0,function(){var a,i,s,o,d;return O(this,function(c){switch(c.label){case 0:return(n=e==null?void 0:e.persist)===null||n===void 0||n.call(e),a=this.props,i=a.dispatchEvent,s=a.data,o=a.onRow,[4,i("rowMouseLeave",N(s,{item:t,index:r}))];case 1:return d=c.sent(),d!=null&&d.prevented?[2]:(t&&o&&o.onRowMouseLeave&&o.onRowMouseLeave(e,t,r),[2])}})})},l.prototype.handleOrderChange=function(e,t,r){return A(this,void 0,void 0,function(){var n,a;return O(this,function(i){return n=this.props.store,a=n.getRowByIndex(e,r),n.exchange(e,t,a),[2]})})},l.prototype.handleSaveOrder=function(){return A(this,void 0,void 0,function(){var e,t,r,n,a,i,s,o;return O(this,function(d){switch(d.label){case 0:return e=this.props,t=e.store,r=e.onSaveOrder,n=e.data,a=e.dispatchEvent,i=t.movedRows.map(function(c){return c.data}),s=t.rows.map(function(c){return c.getDataWithModifiedChilden()}),[4,a("orderChange",N(n,{movedItems:i}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2]:!r||!t.movedRows.length?[2]:(r(i,s),[2])}})})},l.prototype.doAction=function(e,t,r,n){var a=this,i=this.props,s=i.store,o=i.data,d=i.keyField,c=i.expandable,v=i.primaryField,b=e==null?void 0:e.actionType,f=s.keyField,u=s.getData(o).items||[];switch(b){case"selectAll":s.updateSelectedAll();break;case"clearAll":s.updateSelected([]);break;case"select":var m=[];u.forEach(function(E,T){var _=L((n==null?void 0:n.selected)||(n==null?void 0:n.selectedRowKeysExpr),{record:E,rowIndex:T});_&&m.push(E[f])}),s.updateSelected(m);break;case"expand":var g=v||(c==null?void 0:c.keyField)||d,h=[],R=[];if(n!=null&&n.value){var w=u.findIndex(function(E){return E[g]===n.value}),k=u[w];this.tableRef&&this.tableRef.isExpandableRow(k,w)&&(this.tableRef.isExpanded(k)?R.push(k):h.push(k))}else n!=null&&n.expandedRowsExpr&&u.forEach(function(E,T){var _=L(n==null?void 0:n.expandedRowsExpr,{record:E,rowIndex:T});_&&a.tableRef&&a.tableRef.isExpandableRow(E,T)&&(a.tableRef.isExpanded(E)?R.push(E):h.push(E))});h.length>0&&this.tableRef&&this.tableRef.onExpandRows(h),R.length>0&&this.tableRef&&this.tableRef.onCollapseRows(R);break;default:this.handleAction(void 0,e,o);break}},l.prototype.getRef=function(e){this.tableRef=e},l.prototype.renderTable=function(){var e=this.props,t=e.render,r=e.title,n=e.footer;e.rowSelection,e.selectable,e.multiple,e.columns,e.expandable;var a=e.footSummary,i=e.headSummary,s=e.loading,o=e.classnames,d=e.placeholder;e.rowClassNameExpr;var c=e.itemActions,v=e.keyField,b=e.primaryField;e.maxKeepItemSelectionLength;var f=e.onRow,u=e.store,m=e.id,g=e.themeCss,h=$(e,["render","title","footer","rowSelection","selectable","multiple","columns","expandable","footSummary","headSummary","loading","classnames","placeholder","rowClassNameExpr","itemActions","keyField","primaryField","maxKeepItemSelectionLength","onRow","store","id","themeCss"]),R=void 0;if(c){var w=Array.isArray(c)?c.filter(function(E){return!E.hiddenOnHover}):[];if(!w.length)return null;R=function(E,T){return C.createElement("div",{className:o("Table-itemActions")},w.map(function(_,j){return t("itemAction/".concat(j),y(y({},_),{isMenuItem:!0}),{key:j,item:E,data:E,rowIndex:T})}))}}var k={data:this.props.data};return C.createElement(De,y({},h,{headerClassName:G(y(y({},this.props),{name:"tableHeadClassname",id:m,themeCss:g})),bodyClassname:G(y(y({},this.props),{name:"tableBodyClassname",id:m,themeCss:g})),onRef:this.getRef,title:this.renderSchema("title",r,k),footer:this.renderSchema("footer",n,k),columns:this.columns,dataSource:u.dataSource,rowSelection:this.rowSelection,rowClassName:this.rowClassName,expandable:this.expandable,footSummary:this.buildSummary("footSummary",a),headSummary:this.buildSummary("headSummary",i),loading:this.renderSchema("loading",s,k),placeholder:this.renderSchema("placeholder",d,k),onSelect:this.handleSelected,onSelectAll:this.handleSelected,onSort:this.handleSort,onFilter:this.handleFilter,onDrag:this.handleOrderChange,itemActions:R,keyField:b||v,onRow:y(y({},f),{onRowClick:this.handleRowClick,onRowDbClick:this.handleRowDbClick,onRowMouseEnter:this.handleRowMouseEnter,onRowMouseLeave:this.handleRowMouseLeave})}))},l.prototype.renderHeading=function(){var e=this.props,t=e.store,r=e.hideQuickSaveBtn,n=e.classnames,a=e.headingClassName,i=e.saveImmediately,s=e.quickSaveApi,o=e.translate,d=e.columns,c=!1;if(t.modifiedRows.length===1){var v=(d==null?void 0:d.map(function(u){var m;return!((m=u==null?void 0:u.quickEdit)===null||m===void 0)&&m.saveImmediately?u==null?void 0:u.name:""}).filter(function(u){return u}))||[],b=t.modifiedRows[0],f=X(b.data,b.pristine);Ie(v,Object.keys(f)).length&&(c=!0)}return s&&!i&&!c&&t.modified&&!r||t.moved?C.createElement("div",{className:n("Table-heading",a),key:"heading"},!i&&t.modified&&!r&&!c?C.createElement("span",null,o("Table.modified",{modified:t.modified}),C.createElement("button",{type:"button",className:n("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSave},C.createElement(V,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),C.createElement("button",{type:"button",className:n("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},C.createElement(V,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):t.moved?C.createElement("span",null,o("Table.moved",{moved:t.moved}),C.createElement("button",{type:"button",className:n("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSaveOrder},C.createElement(V,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),C.createElement("button",{type:"button",className:n("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},C.createElement(V,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):""):null},l.prototype.render=function(){var e=this.props,t=e.classnames,r=e.style,n=e.store,a=e.themeCss,i=e.wrapperCustomStyle,s=e.id,o=e.env;this.renderedToolbars=[];var d=this.renderHeading();return C.createElement("div",{className:t("Table-render-wrapper",G(y(y({},this.props),{name:"wrapperCustomStyle",id:s,themeCss:i})),{"Table--unsaved":!!n.modified||!!n.moved}),style:r},this.renderActions("header"),d,this.renderTable(),C.createElement(_e,y({},this.props,{config:{themeCss:a,classNames:[{key:"tableHeadClassname",weights:{default:{inner:".".concat(t("Table-table")," > thead > tr > th"),important:!0}}},{key:"tableHeadClassname",weights:{default:{inner:"> tr > th",important:!0}}},{key:"tableBodyClassname",weights:{default:{inner:"> tbody.".concat(t("Table-tbody")," > tr  td")},hover:{suf:"> tbody > tr",inner:"td",important:!0}}},{key:"tableRowClassname",weights:{default:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))},hover:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))}}}],wrapperCustomStyle:i,id:s},env:o})))},l.contextType=je,l.propsList=["source","columnsTogglable","columns","items","rowSelection","expandable","sticky","itemBadge","popOverContainer","keyField","childrenColumnName","rowClassNameExpr","lineHeight","bordered","footer","maxKeepItemSelectionLength","keepItemSelectionOnPageChange","itemActions","headingClassName","footSummary","headSummary","saveImmediately","selectable","multiple","primaryField","hideQuickSaveBtn","selected","placeholder","autoFillHeight"],l.defaultProps={keyField:"id",canAccessSuperData:!1,lazyRenderAfter:100},S([x,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",void 0)],l.prototype,"getPopOverContainer",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Number,Number]),p("design:returntype",void 0)],l.prototype,"subFormRef",null),S([x,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",void 0)],l.prototype,"reset",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"rowClassName",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"expandedRowClassName",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"expandedRowRender",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Number,Array]),p("design:returntype",void 0)],l.prototype,"rowExpandable",null),S([x,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",Promise)],l.prototype,"handleSave",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Array,Array,Object,Object]),p("design:returntype",void 0)],l.prototype,"handleQuickSave",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Object,Boolean,Object]),p("design:returntype",void 0)],l.prototype,"handleQuickChange",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Object]),p("design:returntype",void 0)],l.prototype,"handleAction",null),S([x,p("design:type",Function),p("design:paramtypes",[Array,Array,Array]),p("design:returntype",Promise)],l.prototype,"handleSelected",null),S([x,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],l.prototype,"handleSort",null),S([x,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],l.prototype,"handleFilter",null),S([x,p("design:type",Function),p("design:paramtypes",[String,Object]),p("design:returntype",Promise)],l.prototype,"handleSearch",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowClick",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowDbClick",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowMouseEnter",null),S([x,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowMouseLeave",null),S([x,p("design:type",Function),p("design:paramtypes",[Number,Number,Array]),p("design:returntype",Promise)],l.prototype,"handleOrderChange",null),S([x,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",Promise)],l.prototype,"handleSaveOrder",null),S([x,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],l.prototype,"getRef",null),l}(C.Component),Ue=function(F){J(l,F);function l(){return F!==null&&F.apply(this,arguments)||this}return l.prototype.receive=function(e,t){var r,n,a,i=this.context;if(!((r=this.props)===null||r===void 0)&&r.host)return(a=(n=this.props.host).receive)===null||a===void 0?void 0:a.call(n,e,t);if(t)return i.send(t,e)},l.prototype.reload=function(e,t,r){var n,a,i,s,o=this.context;if((n=o==null?void 0:o.parent)===null||n===void 0||n.getComponents(),!((a=this.props)===null||a===void 0)&&a.host)return(s=(i=this.props.host).reload)===null||s===void 0?void 0:s.call(i,e,t,r);if(e)return o.reload(e,r)},l.prototype.setData=function(e,t,r,n){var a;return A(this,void 0,void 0,function(){var i,s,o,d,c,v,b,f,u;return O(this,function(m){switch(m.label){case 0:return i=this.props.store,s=i.data.rows.length,r===void 0?[3,1]:(o=z([],U(i.data.rows),!1),d=String(r).split(","),d.forEach(function(g){var h=Number(g);o.splice(h,1,e)}),[2,i.updateData({rows:o},void 0,t)]);case 1:if(n===void 0)return[3,6];c=z([],U(i.data.rows),!1),v=0,m.label=2;case 2:return v<s?(b=c[v],[4,Le(n,b)]):[3,5];case 3:f=m.sent(),f&&c.splice(v,1,e),m.label=4;case 4:return v++,[3,2];case 5:return[2,i.updateData({rows:c},void 0,t)];case 6:return u=y(y({},e),{rows:(a=e.rows)!==null&&a!==void 0?a:e.items}),[2,i.updateData(u,void 0,t)]}})})},l.prototype.getData=function(){var e=this.props,t=e.store,r=e.data;return t.getData(r)},l=S([be({type:"table2",storeType:Ke.name,name:"table2",isolateScope:!0})],l),l}(Qe);export{Ue as TableRenderer,Qe as default};
